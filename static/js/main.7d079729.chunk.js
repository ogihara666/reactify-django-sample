(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{152:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(25),c=r.n(a),i=(r(65),r(7)),l=r(8),s=r(11),u=r(9),m=r(12),d=(r(67),r(69),r(26)),h=r.n(d),p=function(e){return 0==e.schedule.cellWidth?o.a.createElement("div",{class:"cell-under",key:e.key,style:{height:"".concat(5*e.schedule.cellHeight+.1*e.schedule.cellHeight,"rem")}}):0==e.schedule.cellHeight?o.a.createElement("div",null):o.a.createElement(h.a,{button:!0,key:e.key,style:{width:"".concat(100*e.schedule.cellWidth,"%"),margin:0,padding:0,backgroundColor:"#00b8d4",borderRadius:"0.4rem",boxSizing:"border-box"}},o.a.createElement("div",{class:"li-fillingCell",style:{height:"".concat(5*e.schedule.cellHeight,"rem"),zIndex:1},onClick:function(){e.clickAction(e.schedule.uuid)}},e.schedule.userName,o.a.createElement("br",null),"\u300c",e.schedule.content,"\u300d"))},f=function(e){return e.index%2==0?o.a.createElement(h.a,{style:{width:"100%",margin:0,padding:0},button:!0,onClick:function(){return e.clickAction("".concat(e.targetDatetime," ").concat(e.time),e.roomId)},key:e.index},o.a.createElement("div",{className:"li-blankCell box-even-black"})):o.a.createElement(h.a,{style:{width:"100%",margin:0,padding:0},button:!0,onClick:function(){return e.clickAction("".concat(e.targetDatetime," ").concat(e.time),e.roomId)},key:e.index},o.a.createElement("div",{className:"li-blankCell box-odd-black"}))},g=function(e){return 0==e.schedule?o.a.createElement(f,{key:e.index,index:e.index,clickAction:e.postEvent,time:e.time,targetDatetime:e.targetDatetime,roomId:e.roomId}):o.a.createElement(p,{key:e.index,schedule:e.schedule,index:e.index,clickAction:e.editEvent})},E=function(e){return o.a.createElement("div",{class:"box-scheduleHeader"},o.a.createElement("div",{class:"item-scheduleHeader"},"\u4f1a\u8b70\u5ba4",e.roomId))},y=function(e){return o.a.createElement("div",{class:"box-clockLine",style:{top:"".concat(e.top,"rem")}})},v=function(e){for(var t=[],r=1;r<=49;r++)t.push(!1);var n=e.scheduleList;for(var a in n)if(t[a]=n[a],n[a].cellHeight>1)for(var c=1;c<n[a].cellHeight;c++)t[Number(a)+c]={cellHeight:0};return o.a.createElement("ul",{class:"box-scheduleRow"},o.a.createElement(E,{roomId:e.roomId}),o.a.createElement(y,{top:20}),t.map(function(t,r){return o.a.createElement(g,{roomId:e.roomId,schedule:t,key:r,index:r,editEvent:e.editEvent,postEvent:e.postEvent,time:e.timeList[r],targetDatetime:e.targetDatetime})}))},T=r(10),b=r(1),S=r.n(b),D="http://35.211.249.14/",_={"Content-Type":"application/json"},k=function(e){return function(t){O(e).then(function(e){var r=I(e.schedules);t({type:"FETCH_ALL_SCHEDULES",payload:r})})}},O=function(e){var t=S()(e),r=D+"reserves/".concat(t.format("YYYY"),"/").concat(t.format("MM"),"/").concat(t.format("DD"));return fetch(r,{method:"GET"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(function(e){return e.json()})},I=function(e){var t={1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}};for(var r in e){var n=e[r],o=n.uuid,a=n.user_name,c=n.content,i=S()(n.start_time),l=S()(n.end_time),s=n.room_ids.sort(),u=n.cell_width,m=n.cell_height,d=2*Number(i.format("HH"))+Math.floor(Number(i.format("mm"))/30);for(var h in s){var p=s[h];t[p][d]={uuid:o,roomId:p,startTime:i,endTime:l,userName:a,content:c,cellHeight:m},t[p][d].cellWidth=u,u=0}}return t},M=r(57),Y=function(){return function(e){e({type:"TOGGLE_FORM_VISIBLE",payload:{}})}},C=function(e){var t={1:"\u4f1a\u8b70\u5ba41",2:"\u4f1a\u8b70\u5ba42",3:"\u4f1a\u8b70\u5ba43",4:"\u4f1a\u8b70\u5ba44",5:"\u4f1a\u8b70\u5ba45",6:"\u4f1a\u8b70\u5ba46",7:"\u4f1a\u8b70\u5ba47",8:"\u4f1a\u8b70\u5ba48"},r=[];for(var n in t)e.roomIds.indexOf(Number(n))>=0?r.push(o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"checkbox",className:"select-input-01-checked",name:"room-choice",id:"room-choice-".concat(n),value:n,onClick:function(t){e.roomCheckAction(t.target.value)},checked:!0}),o.a.createElement("label",{for:"room-choice-".concat(n),className:"select-label-01-checked"},t[n]))):r.push(o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"checkbox",className:"select-input-01",name:"room-choice",id:"room-choice-".concat(n),value:n,onClick:function(t){e.roomCheckAction(t.target.value)}}),o.a.createElement("label",{for:"room-choice-".concat(n),className:"select-label-01"},t[n])));return o.a.createElement("div",null,r.map(function(e){return e}))},N=function(e){return o.a.createElement("select",{name:"time-select-".concat(e.name)},e.timeList.map(function(t,r){return e.initialValue=="".concat(t,":00")?o.a.createElement("option",{value:t,selected:!0},t):o.a.createElement("option",{value:t},t)}))},L=function(e){function t(){var e,r;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(r=Object(s.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).backAction=function(e){e.preventDefault(),r.props.toggleFormVisible(),r.props.fetchAllSchedules("".concat(r.props.targetYear,"-").concat(r.props.targetMonth,"-").concat(r.props.targetDate))},r.registAction=function(e){e.preventDefault(),new Promise(function(e,t){r.props.sendPost(r.props.insertSchedule),e()}).then(function(){r.props.toggleFormVisible()}).then(function(){r.props.fetchAllSchedules("".concat(r.props.targetYear,"-").concat(r.props.targetMonth,"-").concat(r.props.targetDate))})},r.changeFormValueAction=function(e){r.props.changeFormValue(e.target.name,e.target.value)},r}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.changeFormValueAction=this.changeFormValueAction.bind(this)}},{key:"render",value:function(){var e=this.props.insertSchedule,t={display:"none"};return this.props.formVisible&&(t.display="flex"),o.a.createElement("div",{className:"box-postForm",style:t},o.a.createElement("form",{className:"form-simple-01"},o.a.createElement("div",{class:"flex-row-90"},o.a.createElement(N,{name:"startTime",initialValue:e.startTime.split(" ")[1],timeList:this.props.timeList}),"\u304b\u3089",o.a.createElement(N,{name:"endTime",initialValue:e.endTime.split(" ")[1],timeList:this.props.timeList}),"\u307e\u3067"),o.a.createElement("div",{className:"flex-row-90"},o.a.createElement(C,{roomIds:e.roomIds,roomCheckAction:this.props.toggleRoomCheck})),o.a.createElement("div",{className:"flex-row-90"},o.a.createElement("input",{type:"text",className:"input-text-01",placeholder:"\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",name:"userName",onChange:this.changeFormValueAction})),o.a.createElement("div",{className:"flex-row-90"},o.a.createElement("textarea",{placeholder:"\u5185\u5bb9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",className:"input-text-02",name:"content",onChange:this.changeFormValueAction})),o.a.createElement("div",{className:"flex-end-90"},o.a.createElement("button",{onClick:this.backAction,className:"btn-simple-01"},"\u623b\u308b"),o.a.createElement("button",{onClick:this.registAction,className:"btn-simple-01"},"\u767b\u9332"))))}}]),t}(n.Component),x=Object(T.b)(function(e){return{formVisible:e.form.formVisible,insertSchedule:e.form.insertSchedule,roomSelected:{1:e.form.roomSelected[1],2:e.form.roomSelected[2],3:e.form.roomSelected[3],4:e.form.roomSelected[4],5:e.form.roomSelected[5],6:e.form.roomSelected[6],7:e.form.roomSelected[7],8:e.form.roomSelected[8]},targetYear:e.general.targetYear,targetMonth:e.general.targetMonth,targetDate:e.general.targetDate}},{toggleFormVisible:Y,changeFormValue:function(e,t){return function(r){r({type:"CHANGE_FORM_VALUE",payload:Object(M.a)({target:e,value:t},"value",t)})}},sendPost:function(e){return function(t){var r=function(e){var t=e.roomIds;console.log(t);var r,n=[],o={user_name:e.userName,content:e.content,start_time:e.startTime,end_time:e.endTime,room_ids:[]};for(var a in t)0==a?o.room_ids.push(t[a]):t[a-1]+1==t[a]?o.room_ids.push(t[a]):(r=Object.assign({},o),n.push(r),o.room_ids=[t[a]]);return n.push(o),n}(e),n=JSON.stringify({insert_schedules:r});fetch("http://35.211.249.14/reserves",{method:"POST",headers:_,body:n}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(function(r){O(e.startTime).then(function(e){var r=I(e.schedules);t({type:"SEND_POST",payload:r})})}).catch(function(e){alert(e)})}},toggleRoomCheck:function(e){return function(t){t({type:"TOGGLE_ROOM_CHECK",payload:Number(e)})}},fetchAllSchedules:k})(L),A=function(e){return o.a.createElement("ul",{class:"box-scheduleTimeRow"},o.a.createElement("li",{class:"box-scheduleHeader"}),e.timeList.map(function(e,t){return t%2==0?o.a.createElement("li",{class:"item-scheduleTimeRow box-even"},e):o.a.createElement("li",{class:"item-scheduleTimeRow box-odd"},e)}))},H=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;setInterval(function(){e.props.fetchAllSchedules("".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate)),e.props.updateTime()},12e4)}},{key:"componentDidMount",value:function(){this.props.fetchAllSchedules("".concat(this.props.targetYear,"-").concat(this.props.targetMonth,"-").concat(this.props.targetDate))}},{key:"render",value:function(){for(var e=this,t=[],r=1;r<=8;r++)t.push(r);return o.a.createElement("div",{class:"box-schedules"},o.a.createElement(A,{timeList:this.props.timeList}),t.map(function(t){return o.a.createElement(v,{timeList:e.props.timeList,key:t,roomId:t,scheduleList:e.props.schedules[t],targetDatetime:"".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate),editEvent:function(t){e.props.selectSchedule(t),e.props.toggleEditForm()},postEvent:e.props.selectBlank})}))}}]),t}(n.Component),j=Object(T.b)(function(e){return{schedules:e.api.schedules,currentHour:e.general.currentHour,currentMinute:e.general.currentMinute,targetYear:e.general.targetYear,targetMonth:e.general.targetMonth,targetDate:e.general.targetDate}},{fetchAllSchedules:k,selectBlank:function(e,t){return function(r){console.log(e),r({type:"SELECT_BLANK",payload:{startTime:S()(e).format("YYYY-MM-DD HH:mm:00"),endTime:S()(e).add(30,"m").format("YYYY-MM-DD HH:mm:00"),roomId:t}})}},selectSchedule:function(e){return function(t){fetch("http://35.211.249.14/"+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){if(!e.ok)throw alert("\u5931\u6557\u3057\u307e\u3057\u305f.\u3059\u3067\u306b\u5b58\u5728\u3057\u306a\u3044\u4e88\u5b9a\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059."),Error(e.statusText);return e.json()}).then(function(e){var t=e.schedule;return{uuid:t.uuid,startTime:S()(String(t.start_time)).format("YYYY-MM-DD HH:mm:ss"),endTime:S()(String(t.end_time)).format("YYYY-MM-DD HH:mm:ss"),userName:t.user_name,content:t.content,created:t.created,edited:t.edited,roomIds:t.room_ids}}).then(function(e){t({type:"SELECT_SCHEDULE",payload:{schedule:e,roomSelected:function(e){for(var t={},r=1;r<=8;r++)e.indexOf(r)>=0?t[r]=!0:t[r]=!1;return t}(e.roomIds)}})})}},updateTime:function(){return function(e){var t=S()();e({type:"UPDATE_TIME",payload:{isoWeekday:t.isoWeekday(),year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),hour:t.format("HH"),minute:t.format("mm")}})}},toToday:function(){return function(e){var t=S()();e({type:"TO_TODAY",payload:{year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),isoWeekday:t.isoWeekday()}})}},toggleEditForm:function(){return function(e){e({type:"TOGGLE_EDIT_FORM",payload:{}})}}})(H),w=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("form",null))}}]),t}(n.Component),V=Object(T.b)(function(e){return{schedule:{uuid:e.form.scheduleTouched.uuid,edited:e.form.scheduleTouched.edited,created:e.form.scheduleTouched.created,content:e.form.scheduleTouched.content,userName:e.form.scheduleTouched.userName,roomIds:e.form.scheduleTouched.roomIds,startTime:e.form.scheduleTouched.startTime,endTime:e.form.scheduleTouched.endTime},editing:e.form.editing,roomSelected:{1:e.form.roomSelected[1],2:e.form.roomSelected[2],3:e.form.roomSelected[3],4:e.form.roomSelected[4],5:e.form.roomSelected[5],6:e.form.roomSelected[6],7:e.form.roomSelected[7],8:e.form.roomSelected[8]},targetYear:e.general.targetYear,targetMonth:e.general.targetMonth,targetDate:e.general.targetDate}},{fetchAllSchedules:k,sendPatch:function(e){return function(t){var r=JSON.stringify({schedules:{uuid:e.uuid,content:e.content,user_name:e.userName,room_ids:e.roomIds,start_time:e.startTime,end_time:e.endTime}});fetch("http://35.211.249.14/reserves",{method:"PUT",headers:_,body:r}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(t({type:"SEND_PATCH",payload:{}}))}},toggleFormVisible:Y,toggleRoomCheckInEditing:function(e){return function(t){t({type:"TOGGLE_ROOM_CHECK_IN_EDITING",payload:e})}},changeEditValue:function(e,t){return function(r){r({type:"CHANGE_EDIT_VALUE",payload:{target:e,value:t}})}}})(w),F=["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00"],G=function(e){function t(){return Object(i.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(j,{timeList:F}),o.a.createElement(x,{timeList:F}),o.a.createElement(V,{timeList:F}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=r(13),W={schedules:{1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}}},P={roomTouched:0,scheduleTouched:{uuid:"",roomIds:[],startTime:"",endTime:"",userName:"",content:"",edited:"",created:""},formVisible:!1,editing:!1,insertSchedule:{roomIds:[],startTime:"",endTime:"",userName:"",content:""},roomSelected:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}},U={currentYear:S()().format("YYYY"),currentMonth:S()().format("MM"),currentDate:S()().format("DD"),currentDay:S()().isoWeekday(),currentHour:S()().format("HH"),currentMinute:S()().format("mm"),targetYear:S()().format("YYYY"),targetMonth:S()().format("MM"),targetDay:B(S()().isoWeekday()),targetDate:S()().format("DD")};function B(e){switch(e){case 1:return"\u6708";case 2:return"\u706b";case 3:return"\u6c34";case 4:return"\u6728";case 5:return"\u91d1";case 6:return"\u571f";case 7:return"\u65e5"}}var K=Object(R.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ALL_SCHEDULES":return{schedules:t.payload};case"SEND_POST":default:return e}},form:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0,r=Object.assign({},e);switch(t.type){case"TOGGLE_EDIT_FORM":return r.editing=!r.editing,r.roomSelected={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1},r;case"SELECT_SCHEDULE":r.editing=!0;var n=t.payload.schedule;return r.scheduleTouched=n,r.roomSelected=t.payload.roomSelected,r;case"CHANGE_FORM_VALUE":var o=t.payload.target,a=t.payload.value;return r.insertSchedule[o]=a,r;case"CHANGE_EDIT_VALUE":var c=t.payload.target,i=t.payload.value;return r.scheduleTouched[c]=i,r;case"SELECT_BLANK":return r.insertSchedule.roomIds=[t.payload.roomId],r.roomSelected[t.payload.roomId]=!0,r.insertSchedule.startTime=t.payload.startTime,r.insertSchedule.endTime=t.payload.endTime,r.formVisible=!0,r;case"TOGGLE_FORM_VISIBLE":return{roomTouched:0,scheduleTouched:"",formVisible:!1,editing:!1,insertSchedule:{roomIds:[],startTime:"",endTime:"",userName:"",content:""},roomSelected:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}};case"TOGGLE_ROOM_CHECK":var l=t.payload;r.roomSelected[l]=!r.roomSelected[l];var s=r.insertSchedule.roomIds.indexOf(l);return s>=0?r.insertSchedule.roomIds.splice(s,1):r.insertSchedule.roomIds.push(t.payload),r;case"TOGGLE_ROOM_CHECK_IN_EDITING":var u=t.payload;r.roomSelected[u]=!r.roomSelected[u];var m=r.scheduleTouched.roomIds.indexOf(u);return m>=0?r.scheduleTouched.roomIds.splice(m,1):r.scheduleTouched.roomIds.push(u),r;default:return Object.assign({},e)}},general:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0,r=Object.assign({},e);switch(t.type){case"UPDATE_TIME":return r.currentDay=B(t.payload.isoWeekday),r.currentYear=t.payload.year,r.currentMonth=t.payload.month,r.currentDate=t.payload.date,r.currentHour=t.payload.hour,r.currentMinute=t.payload.minute,r;case"SELECT_DATE":case"ADD_DATE":case"TO_TODAY":return r.targetYear=t.payload.year,r.targetMonth=t.payload.month,r.targetDate=t.payload.date,r.targetDay=B(t.payload.isoWeekday),r;default:return r}}}),J=[r(58).a],z=Object(R.e)(K,{},Object(R.d)(R.a.apply(void 0,J))),$=function(e){return o.a.createElement(T.a,{store:z},e.children)};c.a.render(o.a.createElement($,null,o.a.createElement(G,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},60:function(e,t,r){e.exports=r(152)},65:function(e,t,r){},67:function(e,t,r){},69:function(e,t,r){}},[[60,2,1]]]);
//# sourceMappingURL=main.7d079729.chunk.js.map