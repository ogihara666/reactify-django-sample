(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,r){e.exports=r(35)},25:function(e,t,r){},27:function(e,t,r){},29:function(e,t,r){},35:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(15),c=r.n(o),l=(r(25),r(4)),u=r(5),s=r(9),i=r(6),d=r(10),m=(r(27),r(29),r(3)),h={schedules:{1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}}},f={roomTouched:0,scheduleTouched:{uuid:"",roomIds:[],startTime:"",endTime:"",userName:"",content:"",edited:"",created:""},formVisible:!1,editing:!1,insertSchedule:{roomIds:[],startTime:"",endTime:"",userName:"",content:""},roomSelected:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}},p=r(1),y=r.n(p),g={currentYear:y()().format("YYYY"),currentMonth:y()().format("MM"),currentDate:y()().format("DD"),currentDay:y()().isoWeekday(),currentHour:y()().format("HH"),currentMinute:y()().format("mm"),targetYear:y()().format("YYYY"),targetMonth:y()().format("MM"),targetDay:E(y()().isoWeekday()),targetDate:y()().format("DD")};function E(e){switch(e){case 1:return"\u6708";case 2:return"\u706b";case 3:return"\u6c34";case 4:return"\u6728";case 5:return"\u91d1";case 6:return"\u571f";case 7:return"\u65e5"}}var v=Object(m.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ALL_SCHEDULES":return{schedules:t.payload};case"SEND_POST":default:return e}},form:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0,r=Object.assign({},e);switch(t.type){case"TOGGLE_EDIT_FORM":return r.editing=!r.editing,r.roomSelected={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1},r;case"SELECT_SCHEDULE":r.editing=!0;var n=t.payload.schedule;return r.scheduleTouched=n,r.roomSelected=t.payload.roomSelected,r;case"CHANGE_FORM_VALUE":var a=t.payload.target,o=t.payload.value;return r.insertSchedule[a]=o,r;case"CHANGE_EDIT_VALUE":var c=t.payload.target,l=t.payload.value;return r.scheduleTouched[c]=l,r;case"SELECT_BLANK":return r.insertSchedule.roomIds=[t.payload.roomId],r.roomSelected[t.payload.roomId]=!0,r.insertSchedule.startTime=t.payload.startTime,r.formVisible=!0,r;case"TOGGLE_FORM_VISIBLE":return{roomTouched:0,scheduleTouched:"",formVisible:!1,editing:!1,insertSchedule:{roomIds:[],startTime:"",endTime:"",userName:"",content:""},roomSelected:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}};case"TOGGLE_ROOM_CHECK":var u=t.payload;r.roomSelected[u]=!r.roomSelected[u];var s=r.insertSchedule.roomIds.indexOf(u);return s>=0?r.insertSchedule.roomIds.splice(s,1):r.insertSchedule.roomIds.push(t.payload),r;case"TOGGLE_ROOM_CHECK_IN_EDITING":var i=t.payload;r.roomSelected[i]=!r.roomSelected[i];var d=r.scheduleTouched.roomIds.indexOf(i);return d>=0?r.scheduleTouched.roomIds.splice(d,1):r.scheduleTouched.roomIds.push(i),r;default:return Object.assign({},e)}},general:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,r=Object.assign({},e);switch(t.type){case"UPDATE_TIME":return r.currentDay=E(t.payload.isoWeekday),r.currentYear=t.payload.year,r.currentMonth=t.payload.month,r.currentDate=t.payload.date,r.currentHour=t.payload.hour,r.currentMinute=t.payload.minute,r;case"SELECT_DATE":case"ADD_DATE":case"TO_TODAY":return r.targetYear=t.payload.year,r.targetMonth=t.payload.month,r.targetDate=t.payload.date,r.targetDay=E(t.payload.isoWeekday),r;default:return r}}}),T=[r(17).a],D=Object(m.e)(v,{},Object(m.d)(m.a.apply(void 0,T))),Y=r(8),S=function(e){return 0==e.schedule.cellWidth?a.a.createElement("div",{class:"cell-under",key:e.key,style:{height:"".concat(5*e.schedule.cellHeight+.1*e.schedule.cellHeight,"rem")}}):0==e.schedule.cellHeight?a.a.createElement("div",null):a.a.createElement("div",{class:"li-fillingCell",key:e.key,style:{width:"".concat(100*e.schedule.cellWidth,"%")}},a.a.createElement("div",{class:"item-fillingCell",style:{height:"".concat(5*e.schedule.cellHeight+.1*(e.schedule.cellHeight-1),"rem"),zIndex:1}},e.schedule.userName,"\u300c",e.schedule.content,"\u300d"))},_=function(e){return a.a.createElement("div",{key:e.key,class:"li-blankCell"})},M=function(e){return 0==e.schedule?a.a.createElement(_,{key:e.key}):a.a.createElement(S,{key:e.key,schedule:e.schedule})},H=function(e){return a.a.createElement("div",{class:"box-scheduleHeader"},a.a.createElement("div",{class:"item-scheduleHeader"},"\u4f1a\u8b70\u5ba4",e.roomId))},O=function(e){return a.a.createElement("div",{class:"box-clockLine",style:{top:"".concat(e.top,"rem")}})},k=function(e){for(var t=[],r=1;r<=49;r++)t.push(!1);var n=e.scheduleList;for(var o in n)if(t[o]=n[o],n[o].cellHeight>1)for(var c=1;c<n[o].cellHeight;c++)t[Number(o)+c]={cellHeight:0};return console.log(t),a.a.createElement("ul",{class:"box-scheduleRow"},a.a.createElement(H,{roomId:e.roomId}),a.a.createElement(O,{top:20}),t.map(function(e,t){return a.a.createElement(M,{schedule:e,key:t})}))},I=(r(7),"http://35.211.249.14/"),b=function(e){var t=y()(e),r=I+"reserves/".concat(t.format("YYYY"),"/").concat(t.format("MM"),"/").concat(t.format("DD"));return console.log(r),fetch(r,{method:"GET"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(function(e){return e.json()})},L=function(e){var t={1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}};for(var r in e){var n=e[r],a=n.uuid,o=n.user_name,c=n.content,l=y()(n.start_time),u=y()(n.end_time),s=n.room_ids.sort(),i=n.cell_width,d=n.cell_height,m=2*Number(l.format("HH"))+Math.floor(Number(l.format("mm"))/30);for(var h in s){var f=s[h];t[f][m]={uuid:a,roomId:f,startTime:l,endTime:u,userName:o,content:c,cellHeight:d},t[f][m].cellWidth=i,i=0}}return t},C=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;setInterval(function(){e.props.fetchAllSchedules("".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate)),e.props.updateTime()},12e4)}},{key:"componentDidMount",value:function(){this.props.fetchAllSchedules("".concat(this.props.targetYear,"-").concat(this.props.targetMonth,"-").concat(this.props.targetDate))}},{key:"render",value:function(){for(var e=this,t=[],r=1;r<=8;r++)t.push(r);return a.a.createElement("div",{class:"box-schedules"},t.map(function(t){return console.log(e.props.schedules[t]),a.a.createElement(k,{key:t,roomId:t,scheduleList:e.props.schedules[t],insertAction:function(){console.log("insert")}})}))}}]),t}(n.Component),w=Object(Y.b)(function(e){return{schedules:e.api.schedules,currentHour:e.general.currentHour,currentMinute:e.general.currentMinute,targetYear:e.general.targetYear,targetMonth:e.general.targetMonth,targetDate:e.general.targetDate}},{fetchAllSchedules:function(e){return function(t){b(e).then(function(e){var r=L(e.schedules);t({type:"FETCH_ALL_SCHEDULES",payload:r})})}},selectBlank:function(e,t){return function(r){r({type:"SELECT_BLANK",payload:{startTime:y()(e).format("YYYY-MM-DD HH:mm:00"),roomId:t}})}},selectSchedule:function(e){return function(t){fetch("http://35.211.249.14/"+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(e){console.log(e);var t=e.schedule;return{uuid:t.uuid,startTime:y()(String(t.start_time)).format("YYYY-MM-DD HH:mm:ss"),endTime:y()(String(t.end_time)).format("YYYY-MM-DD HH:mm:ss"),userName:t.user_name,content:t.content,created:t.created,edited:t.edited,roomIds:t.room_ids}}).then(function(e){t({type:"SELECT_SCHEDULE",payload:{schedule:e,roomSelected:function(e){for(var t={},r=1;r<=8;r++)e.indexOf(r)>=0?t[r]=!0:t[r]=!1;return t}(e.roomIds)}})})}},updateTime:function(){return function(e){var t=y()();e({type:"UPDATE_TIME",payload:{isoWeekday:t.isoWeekday(),year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),hour:t.format("HH"),minute:t.format("mm")}})}},toToday:function(){return function(e){var t=y()();e({type:"TO_TODAY",payload:{year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),isoWeekday:t.isoWeekday()}})}}})(C),j=function(e){function t(){return Object(l.a)(this,t),Object(s.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return a.a.createElement(Y.a,{store:D},a.a.createElement(w,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,2,1]]]);
//# sourceMappingURL=main.6d0127e8.chunk.js.map