(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t,n){"use strict";n.d(t,"l",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"h",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"m",function(){return u}),n.d(t,"k",function(){return d}),n.d(t,"n",function(){return s}),n.d(t,"e",function(){return l}),n.d(t,"i",function(){return m}),n.d(t,"j",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"p",function(){return p}),n.d(t,"g",function(){return y}),n.d(t,"a",function(){return g}),n.d(t,"o",function(){return v});var r="TOGGLE_FORM_VISIBLE",o="SELECT_BLANK",a="SELECT_SCHEDULE",c="CHANGE_FORM_VALUE",i="CHANGE_EDIT_VALUE",u="TOGGLE_ROOM_CHECK",d="TOGGLE_EDIT_FORM",s="TOGGLE_ROOM_CHECK_IN_EDITING",l="SEND_DELETE",m="SEND_PATCH",f="SEND_POST",h="FETCH_ALL_SCHEDULES",p="UPDATE_TIME",y="SELECT_DATE",g="ADD_DATE",v="TO_TODAY"},159:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(20),c=n.n(a),i=(n(69),n(41)),u=n.n(i),d=n(58),s=n(22),l=n(23),m=n(26),f=n(24),h=n(27),p=(n(73),n(75),n(21)),y=n.n(p),g=function(e){return 0==e.schedule.cellWidth?o.a.createElement("div",{class:"cell-under",key:e.key,style:{height:"".concat(5*e.schedule.cellHeight,"rem")}}):0==e.schedule.cellHeight?o.a.createElement("div",null):o.a.createElement(y.a,{button:!0,key:e.key,style:{width:"".concat(100*e.schedule.cellWidth,"%"),margin:0,padding:0,backgroundColor:"#00b8d4",borderRadius:"0.4rem",boxSizing:"border-box"}},o.a.createElement("div",{class:"li-fillingCell",style:{height:"".concat(5*e.schedule.cellHeight,"rem"),zIndex:1},onClick:function(){e.clickAction(e.schedule.uuid)}},o.a.createElement("div",{class:"username-fillingCell"},e.schedule.userName),o.a.createElement("div",{class:"contents-fillingCell"},e.schedule.content)))},v=function(e){return e.index%2==0?o.a.createElement(y.a,{style:{width:"100%",margin:0,padding:0},button:!0,onClick:function(){return e.clickAction("".concat(e.targetDatetime," ").concat(e.time),e.roomId)},key:e.index},o.a.createElement("div",{className:"li-blankCell box-even-black"})):o.a.createElement(y.a,{style:{width:"100%",margin:0,padding:0},button:!0,onClick:function(){return e.clickAction("".concat(e.targetDatetime," ").concat(e.time),e.roomId)},key:e.index},o.a.createElement("div",{className:"li-blankCell box-odd-black"}))},E=function(e){return 0==e.schedule?o.a.createElement(v,{key:e.index,index:e.index,clickAction:e.postEvent,time:e.time,targetDatetime:e.targetDatetime,roomId:e.roomId}):o.a.createElement(g,{key:e.index,schedule:e.schedule,index:e.index,clickAction:e.editEvent})},b=function(e){return o.a.createElement("div",{class:"box-scheduleHeader",style:{backgroundColor:e.color}},o.a.createElement("div",{class:"item-scheduleHeader"},"\u4f1a\u8b70\u5ba4",e.roomId),o.a.createElement("div",{class:"item-scheduleHeader"},"(",e.position,")"))},T=function(e){for(var t=[],n=1;n<=49;n++)t.push(!1);var r=e.scheduleList;for(var a in r)if(t[a]=r[a],r[a].cellHeight>1)for(var c=1;c<r[a].cellHeight;c++)t[Number(a)+c]={cellHeight:0};return o.a.createElement("ul",{class:"box-scheduleRow"},o.a.createElement(b,{roomId:e.roomId,color:e.color,position:e.position}),t.map(function(t,n){return o.a.createElement(E,{roomId:e.roomId,schedule:t,key:n,index:n,editEvent:e.editEvent,postEvent:e.postEvent,time:e.timeList[n],targetDatetime:e.targetDatetime})}))},k=n(25),D=n(43),Y=n(32),_=n(40),M=function(e){var t="#cfd8dc";return o.a.createElement("ul",{class:"box-scheduleTimeRow"},o.a.createElement("li",{class:"box-scheduleHeader"}),e.timeList.map(function(e,n){return"06:00"==e?t="#84ffff":"12:00"==e?t="#ffd180":"18:00"==e&&(t="#b388ff"),n%2==0?o.a.createElement("li",{class:"item-scheduleTimeRow box-even-black",style:{backgroundColor:t},id:e},e):o.a.createElement("li",{class:"item-scheduleTimeRow box-odd-black",style:{backgroundColor:t},id:e},e)}))},S=function(e){function t(){return Object(s.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){var e=this;setInterval(function(){e.props.fetchAllSchedules("".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate)),e.props.updateTime()},12e4)}},{key:"componentDidMount",value:function(){this.props.fetchAllSchedules("".concat(this.props.targetYear,"-").concat(this.props.targetMonth,"-").concat(this.props.targetDate))}},{key:"render",value:function(){var e=this,t=[],n={1:"\u6700\u5965",2:"\u4e2d\u592e",3:"\u624b\u524d"},r={4:"\u7a93\u5074",5:"\u7a93\u624b\u524d",6:"\u5165\u53e3\u5bc4\u308a",7:"\u5165\u53e3\u8fd1\u304f",8:"\u5165\u53e3\u624b\u524d"};return Object.keys(n).forEach(function(r){t.push(o.a.createElement(T,{color:"#1b5e20",position:n[r],timeList:e.props.timeList,key:r,roomId:r,scheduleList:e.props.schedules[r],targetDatetime:"".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate),editEvent:function(t){e.props.selectSchedule(t),e.props.toggleEditForm()},postEvent:e.props.selectBlank}))}),Object.keys(r).forEach(function(n){t.push(o.a.createElement(T,{color:"#bf360c",position:r[n],timeList:e.props.timeList,key:n,roomId:n,scheduleList:e.props.schedules[n],targetDatetime:"".concat(e.props.targetYear,"-").concat(e.props.targetMonth,"-").concat(e.props.targetDate),editEvent:function(t){e.props.selectSchedule(t),e.props.toggleEditForm()},postEvent:e.props.selectBlank}))}),o.a.createElement("div",{class:"box-schedules"},o.a.createElement(M,{timeList:this.props.timeList}),t.map(function(e){return e}))}}]),t}(r.Component),O=Object(k.b)(function(e){return{schedules:e.api.schedules,currentHour:e.general.currentHour,currentMinute:e.general.currentMinute,targetYear:e.general.targetYear,targetMonth:e.general.targetMonth,targetDate:e.general.targetDate}},{fetchAllSchedules:D.a,selectBlank:Y.c,selectSchedule:Y.d,updateTime:_.d,toToday:_.c,toggleEditForm:Y.e})(S),I=["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30","00:00"],H=function(e){function t(){var e,n;Object(s.a)(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(n=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(o)))).state={datePicker:null,postForm:null,editForm:null},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,r,a,c,i,d;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(5),n.e(1)]).then(n.bind(null,167));case 2:return t=e.sent,r=t.default,e.next=6,n.e(2).then(n.bind(null,168));case 6:return a=e.sent,c=a.default,e.next=10,n.e(3).then(n.bind(null,169));case 10:i=e.sent,d=i.default,this.setState({datePicker:o.a.createElement(r,null),editForm:o.a.createElement(c,{timeList:I}),postForm:o.a.createElement(d,{timeList:I})});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,this.state.datePicker||o.a.createElement("div",null,"\u8aad\u307f\u8fbc\u307f\u4e2d..."),o.a.createElement(O,{timeList:I}),this.state.postForm||o.a.createElement("div",null,"\u8aad\u307f\u8fbc\u307f\u4e2d..."),this.state.editForm||o.a.createElement("div",null,"\u8aad\u307f\u8fbc\u307f\u4e2d..."))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var x=n(8),w=n(1),L={schedules:{1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}}},j={roomTouched:0,scheduleTouched:{uuid:"",roomIds:[],startTime:"0000-00-00 00:00:00",endTime:"0000-00-00 00:00:00",userName:"",content:"",edited:"",created:""},formVisible:!1,editing:!1,insertSchedule:{roomIds:[],startTime:"0000-00-00 00:00:00",endTime:"0000-00-00 00:00:00",userName:"",content:""},roomSelected:{1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1}},C=n(2),N=n.n(C),A={currentYear:N()().format("YYYY"),currentMonth:N()().format("MM"),currentDate:N()().format("DD"),currentDay:N()().isoWeekday(),currentHour:N()().format("HH"),currentMinute:N()().format("mm"),targetYear:N()().format("YYYY"),targetMonth:N()().format("MM"),targetDay:W(N()().isoWeekday()),targetDate:N()().format("DD")};function W(e){switch(e){case 1:return"\u6708";case 2:return"\u706b";case 3:return"\u6c34";case 4:return"\u6728";case 5:return"\u91d1";case 6:return"\u571f";case 7:return"\u65e5"}}var F=Object(x.c)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w.d:return{schedules:t.payload};case w.e,w.i,w.j:default:return e}},form:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case w.k:return n.editing=!n.editing,n.roomSelected={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1},n.scheduleTouched={uuid:"",roomIds:[],startTime:"0000-00-00 00:00:00",endTime:"0000-00-00 00:00:00",userName:"",content:"",edited:"",created:""},n;case w.h:n.editing=!0;var r=t.payload.schedule;return n.scheduleTouched=r,n.roomSelected=t.payload.roomSelected,n;case w.c:var o=t.payload.target,a=t.payload.value;return n.insertSchedule[o]=a,n;case w.b:var c=t.payload.target,i=t.payload.value;return n.scheduleTouched[c]=i,n;case w.f:return n.insertSchedule.roomIds=[t.payload.roomId],n.roomSelected[t.payload.roomId]=!0,n.insertSchedule.startTime=t.payload.startTime,n.insertSchedule.endTime=t.payload.endTime,n.formVisible=!0,n;case w.l:return n.roomSelected={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1,7:!1,8:!1},n.insertSchedule={roomIds:[],startTime:"0000-00-00 00:00:00",endTime:"0000-00-00 00:00:00",userName:"",content:""},n.formVisible=!n.formVisible,n;case w.m:var u=t.payload;n.roomSelected[u]=!n.roomSelected[u];var d=n.insertSchedule.roomIds.indexOf(u);return d>=0?n.insertSchedule.roomIds.splice(d,1):n.insertSchedule.roomIds.push(t.payload),n;case w.n:var s=t.payload;n.roomSelected[s]=!n.roomSelected[s];var l=n.scheduleTouched.roomIds.indexOf(s);return l>=0?n.scheduleTouched.roomIds.splice(l,1):n.scheduleTouched.roomIds.push(s),n;default:return Object.assign({},e)}},general:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0,n=Object.assign({},e);switch(t.type){case w.p:return n.currentDay=W(t.payload.isoWeekday),n.currentYear=t.payload.year,n.currentMonth=t.payload.month,n.currentDate=t.payload.date,n.currentHour=t.payload.hour,n.currentMinute=t.payload.minute,n;case w.g:case w.a:case w.o:return n.targetYear=t.payload.year,n.targetMonth=t.payload.month,n.targetDate=t.payload.date,n.targetDay=W(t.payload.isoWeekday),n;default:return n}}}),G=[n(63).a],R=Object(x.e)(F,{},Object(x.d)(x.a.apply(void 0,G))),P=function(e){return o.a.createElement(k.a,{store:R},e.children)};c.a.render(o.a.createElement(P,null,o.a.createElement(H,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},32:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"f",function(){return s}),n.d(t,"g",function(){return l}),n.d(t,"h",function(){return m}),n.d(t,"d",function(){return f}),n.d(t,"e",function(){return h});var r=n(62),o=n(1),a=n(2),c=n.n(a),i=function(e,t){return function(n){n({type:o.c,payload:Object(r.a)({target:e,value:t},"value",t)})}},u=function(e,t){return function(n){n({type:o.b,payload:{target:e,value:t}})}},d=function(e,t){return function(n){n({type:o.f,payload:{startTime:c()(e).format("YYYY-MM-DD HH:mm:00"),endTime:c()(e).add(30,"m").format("YYYY-MM-DD HH:mm:00"),roomId:Number(t)}})}},s=function(){return function(e){e({type:o.l,payload:{}})}},l=function(e){return function(t){t({type:o.m,payload:Number(e)})}},m=function(e){return function(t){t({type:o.n,payload:Number(e)})}},f=function(e){return function(t){fetch("http://35.211.249.14/"+e,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){if(!e.ok)throw alert("\u5931\u6557\u3057\u307e\u3057\u305f.\u3059\u3067\u306b\u5b58\u5728\u3057\u306a\u3044\u4e88\u5b9a\u306e\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059."),Error(e.statusText);return e.json()}).then(function(e){var t=e.schedule;return{uuid:t.uuid,startTime:c()(String(t.start_time)).format("YYYY-MM-DD HH:mm:ss"),endTime:c()(String(t.end_time)).format("YYYY-MM-DD HH:mm:ss"),userName:t.user_name,content:t.content,created:t.created,edited:t.edited,roomIds:t.room_ids}}).then(function(e){t({type:o.h,payload:{schedule:e,roomSelected:function(e){for(var t={},n=1;n<=8;n++)e.indexOf(n)>=0?t[n]=!0:t[n]=!1;return t}(e.roomIds)}})})}},h=function(){return function(e){e({type:o.k,payload:{}})}}},40:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d});var r=n(1),o=n(2),a=n.n(o),c=function(){return function(e){var t=a()();e({type:r.p,payload:{isoWeekday:t.isoWeekday(),year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),hour:t.format("HH"),minute:t.format("mm")}})}},i=function(e){return function(t){var n=a()(e);t({type:r.g,payload:{year:n.format("YYYY"),month:n.format("MM"),date:n.format("DD"),isoWeekday:n.isoWeekday()}})}},u=function(e,t,n,o){return function(c){var i=a()().set({year:t,month:n-1,date:o});i.add(e,"day"),c({type:r.a,payload:{year:i.format("YYYY"),month:i.format("MM"),date:i.format("DD"),isoWeekday:i.isoWeekday()}})}},d=function(){return function(e){var t=a()();e({type:r.o,payload:{year:t.format("YYYY"),month:t.format("MM"),date:t.format("DD"),isoWeekday:t.isoWeekday()}})}}},43:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return l});var r=n(1),o=n(2),a=n.n(o),c="http://35.211.249.14/",i={"Content-Type":"application/json"},u=function(e){return function(t){m(e).then(function(e){var n=f(e.schedules);t({type:r.d,payload:n})})}},d=function(e){return function(t){var n=JSON.stringify({schedules:{uuid:e.uuid,content:e.content,user_name:e.userName,room_ids:e.roomIds,start_time:e.startTime,end_time:e.endTime}});fetch("http://35.211.249.14/reserves",{method:"PUT",headers:i,body:n}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(t({type:r.i,payload:{}}))}},s=function(e){return function(t){var n=JSON.stringify({uuid:e});fetch("http://35.211.249.14/reserves",{method:"DELETE",headers:i,body:n}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(t({type:r.e,payload:{}}))}},l=function(e){return function(t){var n=function(e){var t=e.roomIds.sort();console.log(t);var n,r=[],o={user_name:e.userName,content:e.content,start_time:e.startTime,end_time:e.endTime,room_ids:[]};for(var a in t)if(0==a)o.room_ids.push(t[a]);else{if(!t[a])continue;t[a-1]+1==t[a]?o.room_ids.push(t[a]):(n=Object.assign({},o),r.push(n),o.room_ids=[t[a]])}return r.push(o),r}(e),o=JSON.stringify({insert_schedules:n});fetch("http://35.211.249.14/reserves",{method:"POST",headers:i,body:o}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(function(n){m(e.startTime).then(function(e){var n=f(e.schedules);t({type:r.j,payload:n})})}).catch(function(e){alert(e)})}},m=function(e){var t=a()(e),n=c+"reserves/".concat(t.format("YYYY"),"/").concat(t.format("MM"),"/").concat(t.format("DD"));return fetch(n,{method:"GET"}).then(function(e){if(!e.ok)throw Error(e.statusText);return e}).then(function(e){return e.json()})},f=function(e){var t={1:{},2:{},3:{},4:{},5:{},6:{},7:{},8:{}};for(var n in e){var r=e[n],o=r.uuid,c=r.user_name,i=r.content,u=a()(r.start_time),d=a()(r.end_time),s=r.room_ids.sort(),l=r.cell_width,m=r.cell_height,f=2*Number(u.format("HH"))+Math.floor(Number(u.format("mm"))/30);for(var h in s){var p=s[h];t[p][f]={uuid:o,roomId:p,startTime:u,endTime:d,userName:c,content:i,cellHeight:m},t[p][f].cellWidth=l,l=0}}return t}},64:function(e,t,n){e.exports=n(159)},69:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){}},[[64,6,4]]]);
//# sourceMappingURL=main.e04d7ba0.chunk.js.map